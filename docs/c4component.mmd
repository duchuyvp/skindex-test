flowchart TB
    %% Title
    title["Architecture Diagram for Chat Service API"]
    
    %% Define styles
    classDef person fill:#ffdddd,stroke:#333,stroke-width:2px;
    classDef database fill:#ddeeff,stroke:#333,stroke-width:2px,stroke-dasharray: 5;
    classDef container fill:#ddffdd,stroke:#333,stroke-width:2px;
    classDef boundary stroke:#999,stroke-width:2px,stroke-dasharray: 3;
    
    %% Define elements
    user["User\n\nA user of the chat service"]:::person
    database["Database\n\nPostgreSQL\nStores chat data"]:::database
    
    subgraph Application_Boundary["Application"]
        subgraph Front_End["Front End"]
            web_app["Web Application\n\nFront End Page\nProvides chat interface"]:::container
            mobile_app["Mobile Application\n\nFront End Page\nProvides chat interface"]:::container
        end
        api_service["API Application\n\nFastAPI\nHandles chat operations"]:::container
        subgraph Core["Core"]
            core_factory["Factory\n\nCreates core components"]:::container
            core_repository["Repository\n\nHandles database operations"]:::container
        end
        subgraph Chat_Service["Chat Service"]
            chat_controller["Controller\n\nHandles HTTP requests and responses"]:::container
            chat_service["Service\n\nHandles business logic"]:::container
        end
    end
    
    %% Define relationships
    user -->|Browser| web_app
    user -->|Phone| mobile_app
    web_app -->|HTTP| api_service
    mobile_app -->|HTTP| api_service
    api_service -->|Routes to| chat_controller
    chat_controller -->|Invokes| chat_service
    core_repository -->|Reads from and writes to| database
    chat_service -->|Uses| core_factory
    chat_service -->|Uses| core_repository